pipeline{  
    environment {
        HOME = '.'
    }
  agent any
  tools {nodejs "nodejs"}
    stages {
        stage('Build'){
           steps{
              script{
                sh 'npm install'
              } 
           }   
         }
        stage('Test and Generate Coverage'){
           steps{
              script{
                sh 'npm run coverage'
              } 
           }   
         }         
        stage('ESlint'){
           steps{
              script{
                sh 'npm run lint'
              } 
           }   
         }
        stage('Clone repo'){
           steps{
              script{
                sh 'cd nodejsscan'
                sh 'ls -lrt nodejsscan'
                sh 'su -'
                sh 'apt install python-pip'
                sh 'python3 -m venv venv'
                sh '. venv/bin/activate'
                sh 'pip install -r requirements.txt'
              } 
           }   
         }                                                  
  }
}
